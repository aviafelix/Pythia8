<chapter name="Timelike Showers">
    
<h2>Timelike Showers</h2>

The PYTHIA algorithm for timelike final-state showers is based on
the recent article <ref>Sjo05</ref>, where a transverse-momentum-ordered
evolution scheme is introduced. This algorithm is influenced by
the previous mass-ordered algorithm in PYTHIA <ref>Ben87</ref> and by 
the dipole-emission formulation in Ariadne <ref>Gus86</ref>. From the 
mass-ordered algorithm it inherits a merging procedure for first-order 
gluon-emission matrix elements in essentially all two-body decays 
in the standard model and its minimal supersymmetric extension 
<ref>Nor01</ref>. 

<p/>
The normal user is not expected to call <code>TimeShower</code> directly, 
but only have it called from <code>Pythia</code>. Some of the parameters 
below, in particular <code>TimeShower:alphaSvalue</code>, would be of 
interest for a tuning exercise, however. 

<h3>Main variables</h3>

The amount of QCD radiation in the shower is determined by 
<parm name="TimeShower:alphaSvalue" default="0.1265" 
min="0.06" max="0.25">
The <ei>alpha_strong</ei> value at scale <ei>M_Z^2</ei>. The default 
value corresponds to the one tuned to LEP data (using a first-order 
running), so should be taken rather seriously <ref>Rud04</ref>.
</parm>

<p/>
The actual value is then regulated by the running to the scale 
<ei>pT^2</ei>, at which the shower evaluates <ei>alpha_strong</ei>

<mode name="TimeShower:alphaSorder" default="1" min="0" max="2">
Order at which <ei>alpha_strong</ei> runs,
<option value="0">zeroth order, i.e. <ei>alpha_strong</ei> is kept 
fixed.</option>
<option value="1">first order, which is the normal value.</option>
<option value="2">second order. Since other parts of the code do 
not go to second order there is no strong reason to use this option, 
but there is also nothing wrong with it.</option>
</mode>

<p/>
QED radiation is regulated by the <ei>alpha_electromagnetic</ei>
value at the <ei>pT^2</ei> scale of a branching.
 
<mode name="TimeShower:alphaEMorder" default="1" min="-1" max="1">
The running of <ei>alpha_em</ei>.
<option value="1">first-order running, constrained to agree with
<code>StandardModel:alphaEMmZ</code> at the <ei>Z^0</ei> mass.
</option>
<option value="0">zeroth order, i.e. <ei>alpha_em</ei> is kept 
fixed at its value at vanishing momentum transfer.</option>
<option value="-1">zeroth order, i.e. <ei>alpha_em</ei> is kept 
fixed, but at <code>StandardModel:alphaEMmZ</code>, i.e. its value
at the <ei>Z^0</ei> mass.
</option> 
</mode>

<p/>
The rate of radiation if divergent in the <ei>pT -> 0</ei> limit. Here, 
however, perturbation theory is expected to break down. Therefore an 
effective <ei>pT_min</ei> cutoff parameter is introduced, below which 
no emissions are allowed. The cutoff may be different for QCD and QED 
radiation off quarks, and is mainly a technical parameter for QED 
radiation off leptons.

<parm name="TimeShower:pTmin" default="0.5" min="0.1" max="2.0">
Parton shower cut-off <ei>pT</ei> for QCD emissions.
</parm>

<parm name="TimeShower:pTminChgQ" default="0.5" min="0.1" max="2.0">
Parton shower cut-off <ei>pT</ei> for photon coupling to coloured particle.
</parm>

<parm name="TimeShower:pTminChgL" default="0.0005" min="0.0001" 
max="2.0">
Parton shower cut-off <ei>pT</ei> for pure QED branchings. 
Assumed smaller than (or equal to) <code>pTminChgQ</code>.
</parm>

<p/> 
Shower branchings <ei>gamma -> f fbar</ei>, where <ei>f</ei> is a 
quark or lepton, in part compete with the hard processes involving 
<ei>gamma^*/Z^0</ei> production. In order to avoid overlap it makes
sense to correlate the maximum <ei>gamma</ei> mass allowed in showers
with the minumum <ei>gamma^*/Z^0</ei> mass allowed in hard processes.
In addition, the shower contribution only contains the pure 
<ei>gamma^*</ei> contribution, i.e. not the <ei>Z^0</ei> part, so
the mass spectrum above 50 GeV or so would not be well described.

<parm name="TimeShower:mMaxGamma" default="10.0" min="0.001" 
max="50.0">
Maximum invariant mass allowed for the created fermion pair in a 
<ei>gamma -> f fbar</ei> branching in the shower.
</parm>

<h3>Radiation off octet onium states</h3>

In the current implementation, charmonium and bottomonium production
can proceed either through colour singlet or colour octet mechanisms,
both of them implemented in terms of <ei>2 -> 2</ei> hard processes
such as <ei>g g -> (onium) g</ei>.
In the former case the state does not radiate and the onium therefore 
is produced in isolation, up to normal underlying-event activity. In 
the latter case the situation is not so clear, but it is sensible to 
assume that a shower can evolve. (Assuming, of course, that the 
transverse momentum of the onium state is sufficiently high that  
radiation is of relevance.)

<p/> 
There could be two parts to such a shower. Firstly a gluon (or even a 
quark, though less likely) produced in a hard <ei>2 -> 2</ei> process 
can undergo showering into many gluons, whereof one branches into the 
heavy-quark pair. Secondly, once the pair has been produced, each quark 
can radiate further gluons. This latter kind of emission could easily 
break up a semibound quark pair, but might also create a new semibound 
state where before an unbound pair existed, and to some approximation
these two effects should balance in the onium production rate. 
The showering "off an onium state" as implemented here therefore should 
not be viewed as an accurate description of the emission history
step by step, but rather as an effective approach to ensure that the 
octet onium produced "in the hard process" is embedded in a realistic 
amount of jet activity. 
Of course both the isolated singlet and embedded octet are likely to
be extremes, but hopefully the mix of the two will strike a reasonable 
balance. However, it is possible that some part of the octet production 
occurs in channels where it should not be accompanied by (hard) radiation. 
Therefore reducing the fraction of octet onium states allowed to radiate 
is a valid variation to explore uncertainties. 

<p/>
If an octet onium state is chosen to radiate, the simulation of branchings 
is based on the assumption that the full radiation is provided by an 
incoherent sum of radiation off the quark and off the antiquark of the 
onium state. Thus the splitting kernel is taken to be the normal 
<ei>q -> q g</ei> one, multiplied by a factor of two. Obviously this is 
a simplification of a more complex picture, averaging over factors pulling
in different directions. Firstly, radiation off a gluon ought
to be enhanced by a factor 9/4 relative to a quark rather than the 2
now used, but this is a minor difference. Secondly, our use of the 
<ei>q -> q g</ei> branching kernel is roughly equivalent to always
following the harder gluon in a <ei>g -> g g</ei> branching. This could 
give us a bias towards producing too hard onia. A soft gluon would have 
little phase space to branch into a heavy-quark pair however, so the
bias may not be as big as it would seem at first glance. Thirdly, 
once the gluon has branched into a quark pair, each quark carries roughly 
only half of the onium energy. The maximum energy per emitted gluon should 
then be roughly half the onium energy rather than the full, as it is now. 
Thereby the energy of radiated gluons is exaggerated, i.e. onia become too 
soft. So the second and the third points tend to cancel each other. 

<p/>
Finally, note that the lower cutoff scale of the shower evolution depends 
on the onium mass rather than on the quark mass, as it should be. Gluons
below the octet-onium scale should only be part of the octet-to-singlet 
transition.

<parm name="TimeShower:octetOniumFraction" default="1." min="0." max="1." >
Allow colour-octet charmonium and bottomonium states to radiate gluons.
0 means that no octet-onium states radiate, 1 that all do, with possibility
to interpolate between these two extremes. 
</parm>

<h3>Further variables</h3>

There are several possibilities you can use to switch on or off selected
branching types in the shower, or in other respects simplify the shower.
These should normally not be touched. Their main function is for 
cross-checks.

<flag name="TimeShower:QCDshower" default="on">
Allow a QCD shower, i.e. branchings <ei>q -> q g</ei>, <ei>g -> g g</ei> 
and <ei>g -> q qbar</ei>; on/off = true/false.
</flag>

<mode name="TimeShower:nGluonToQuark" default="5" min="0" max="5">
Number of allowed quark flavours in <ei>g -> q qbar</ei> branchings
(phase space permitting). A change to 4 would exclude 
<ei>g -> b bbar</ei>, etc. 
</mode>

<flag name="TimeShower:QEDshowerByQ" default="on">
Allow quarks to radiate photons, i.e. branchings <ei>q -> q gamma</ei>; 
on/off = true/false.
</flag>

<flag name="TimeShower:QEDshowerByL" default="on">
Allow leptons to radiate photons, i.e. branchings <ei>l -> l gamma</ei>;  
on/off = true/false.
</flag>

<flag name="TimeShower:QEDshowerByGamma" default="on">
Allow photons to branch into lepton or quark pairs, i.e. branchings 
<ei>gamma -> l+ l-</ei> and <ei>gamma -> q qbar</ei>;
on/off = true/false.
</flag>

<mode name="TimeShower:nGammaToQuark" default="5" min="0" max="5">
Number of allowed quark flavours in <ei>gamma -> q qbar</ei> branchings
(phase space permitting). A change to 4 would exclude 
<ei>g -> b bbar</ei>, etc. 
</mode>

<mode name="TimeShower:nGammaToLepton" default="3" min="0" max="3">
Number of allowed lepton flavours in <ei>gamma -> l+ l-</ei> branchings
(phase space permitting). A change to 2 would exclude 
<ei>gamma -> tau+ tau-</ei>, and a change to 1 also 
<ei>gamma -> mu+ mu-</ei>. 
</mode>

<flag name="TimeShower:MEcorrections" default="on">
Use of matrix element corrections where available; on/off = true/false.
</flag>

<flag name="TimeShower:phiPolAsym" default="on">
Azimuthal asymmetry induced by gluon polarization; on/off = true/false.
</flag>

</chapter>

<!-- Copyright C 2007 Torbjorn Sjostrand -->
